{"ast":null,"code":"var _jsxFileName = \"/home/jaime/Documents/React_Feed-ReactCourse2020/src/components/Feed/Profile.js\";\nimport React, { Component } from 'react';\nimport { withRouter } from 'react-router-dom';\nimport NavFeed from './NavFeed';\nimport Post from './Post';\nimport MyPost from './MyPost';\n\nclass Profile extends Component {\n  constructor(props) {\n    super(props); //localStorage.getItem('token') && this.props.history.push('/');\n\n    this.likeHandler = index => {\n      let postsAux = [...this.state.myPosts];\n      const config = {\n        method: \"PUT\",\n        headers: {\n          'Content-type': 'Application/json',\n          authorization: `Bearer ${this.state.token}`\n        },\n        body: JSON.stringify(postsAux[index])\n      };\n      /* fetch('https://reactcourseapi.herokuapp.com/post/', config)\n          .then(res => {this.fetchData()}) */\n\n      fetch('https://reactcourseapi.herokuapp.com/post/like', config).then(res => {\n        this.fetchUserData();\n      });\n    };\n\n    this.deleteHandler = index => {\n      let postsAux = [...this.state.myPosts];\n      const config = {\n        method: \"DELETE\",\n        headers: {\n          'Content-type': 'Application/json',\n          authorization: `Bearer ${this.state.token}`\n        },\n        body: JSON.stringify(postsAux[index]._id)\n      };\n    };\n\n    this.fetchUserData = () => {\n      let config = {\n        method: \"GET\",\n        headers: {\n          'Content-type': 'Application/json',\n          authorization: `Bearer ${this.state.token}`\n        }\n      };\n      fetch('https://reactcourseapi.herokuapp.com/user/', config).then(res => res.json()).then(data => {\n        console.log(data.user.posts);\n        this.setState({\n          myPosts: data.user.posts || ''\n        });\n      });\n    };\n\n    this.fetchUsername = () => {\n      let config = {\n        method: \"GET\",\n        headers: {\n          'Content-type': 'Application/json',\n          authorization: `Bearer ${this.state.token}`\n        }\n      };\n      fetch('https://reactcourseapi.herokuapp.com/user/name', config).then(res => res.json()).then(data => {\n        this.setState({\n          username: data.username || ''\n        });\n      });\n    };\n\n    this.state = {\n      myPosts: [],\n      username: \"\",\n      token: localStorage.getItem('token')\n    };\n  }\n\n  componentDidMount() {\n    this.fetchUserData();\n    this.fetchUsername();\n  }\n\n  render() {\n    const myPostsComponents = this.state.myPosts.map((post, index) => {\n      return React.createElement(MyPost, {\n        id: post.id,\n        key: index,\n        name: this.state.username,\n        likes: post.likes,\n        title: post.title,\n        text: post.text,\n        image: post.image,\n        onClick: () => this.likeHandler(index),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 103\n        },\n        __self: this\n      });\n    });\n    return React.createElement(React.Fragment, null, React.createElement(NavFeed, {\n      username: this.state.username,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 108\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109\n      },\n      __self: this\n    }, React.createElement(\"h1\", {\n      className: \"display-3\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110\n      },\n      __self: this\n    }, \"ReactFeed\"), React.createElement(\"h2\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111\n      },\n      __self: this\n    }, \"My Posts\"), React.createElement(\"div\", {\n      className: \"user-btns\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      onClick: () => {\n        this.props.history.push('/newpost');\n      },\n      type: \"button\",\n      className: \"btn btn-outline-info\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 114\n      },\n      __self: this\n    }, \"Nuevo Post\")), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"posts\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117\n      },\n      __self: this\n    }, myPostsComponents)));\n  }\n\n}\n\nexport default withRouter(Profile);","map":{"version":3,"sources":["/home/jaime/Documents/React_Feed-ReactCourse2020/src/components/Feed/Profile.js"],"names":["React","Component","withRouter","NavFeed","Post","MyPost","Profile","constructor","props","likeHandler","index","postsAux","state","myPosts","config","method","headers","authorization","token","body","JSON","stringify","fetch","then","res","fetchUserData","deleteHandler","_id","json","data","console","log","user","posts","setState","fetchUsername","username","localStorage","getItem","componentDidMount","render","myPostsComponents","map","post","id","likes","title","text","image","history","push"],"mappings":"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","sourcesContent":["import React,{Component} from 'react';\nimport {withRouter} from 'react-router-dom';\nimport NavFeed from './NavFeed';\nimport Post from './Post';\nimport MyPost from './MyPost';\n\nclass Profile extends Component{\n    constructor(props){\n        super(props);\n\n\n        //localStorage.getItem('token') && this.props.history.push('/');\n\n        this.state = {\n            myPosts : [],\n            username : \"\",\n            token : localStorage.getItem('token'),\n        }\n    }\n\n    likeHandler = index => {\n        let postsAux = [...this.state.myPosts];\n    \n        const config = {\n            method: \"PUT\",\n            headers: {\n                'Content-type': 'Application/json',\n                authorization: `Bearer ${this.state.token}`\n            },\n            body: JSON.stringify(postsAux[index])\n        }\n    \n        /* fetch('https://reactcourseapi.herokuapp.com/post/', config)\n            .then(res => {this.fetchData()}) */\n    \n            fetch('https://reactcourseapi.herokuapp.com/post/like', config)\n            .then(res => {this.fetchUserData()})\n            \n    }\n\n    deleteHandler = index => {\n        let postsAux = [...this.state.myPosts];\n\n        const config = {\n            method : \"DELETE\",\n            headers: {\n                'Content-type': 'Application/json',\n                authorization: `Bearer ${this.state.token}`\n            },\n            body: JSON.stringify(postsAux[index]._id),\n        }\n\n        \n    }\n\n    fetchUserData = () => {\n        let config = {\n            method: \"GET\",\n            headers: {\n                'Content-type': 'Application/json',\n                authorization: `Bearer ${this.state.token}`\n            }\n        }\n\n        fetch('https://reactcourseapi.herokuapp.com/user/', config)\n            .then(res => res.json())\n            .then(data => {\n                console.log(data.user.posts);\n                this.setState({\n                    myPosts : data.user.posts || ''\n                })   \n            })\n    }\n\n    fetchUsername = () => {\n        let config = {\n            method: \"GET\",\n            headers: {\n                'Content-type': 'Application/json',\n                authorization: `Bearer ${this.state.token}`\n            }\n        }\n    \n        fetch('https://reactcourseapi.herokuapp.com/user/name', config)\n            .then(res => res.json())\n            .then(data => {\n                this.setState({\n                    username: data.username || ''\n                })\n    \n            })\n    }\n\n    componentDidMount(){\n        this.fetchUserData();\n        this.fetchUsername();\n    }\n\n    render(){\n\n        const myPostsComponents = this.state.myPosts.map((post,index) => {\n\n            return(<MyPost id={post.id} key={index} name={this.state.username} likes={post.likes} title={post.title} text={post.text} image={post.image} onClick = {() => this.likeHandler(index)}/>);\n        });\n\n        return(\n            <>\n                <NavFeed username={this.state.username} />\n                <div className=\"container\">\n                    <h1 className=\"display-3\">ReactFeed</h1>\n                    <h2>My Posts</h2>\n\n                    <div className=\"user-btns\">\n                    <button onClick={()=>{this.props.history.push('/newpost')}} type=\"button\" className=\"btn btn-outline-info\">Nuevo Post</button>\n                    </div>\n                    <br/>\n                    <div className=\"posts\">\n                        {myPostsComponents}\n                    </div>\n                </div>\n            </>\n        );\n    }\n\n}\n\nexport default withRouter(Profile);"]},"metadata":{},"sourceType":"module"}