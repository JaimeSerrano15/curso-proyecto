{"ast":null,"code":"var _jsxFileName = \"/home/jaime/Documents/React_Feed-ReactCourse2020/src/components/Splash.js\";\nimport React, { Component } from \"react\";\nimport { withRouter } from \"react-router-dom\";\n\nclass Splash extends Component {\n  constructor(props) {\n    super(props);\n\n    this.verifyToken = async token => {\n      let config = {\n        method: 'GET',\n        headers: {\n          authorization: `Bearer ${token}`\n        }\n      };\n      fetch('https://reactcourseapi.herokuapp.com/verifytoken', config).then(res => {\n        if (res.ok) {\n          this.setState({\n            loading: false\n          });\n          clearInterval(this.interval);\n        } else {\n          localStorage.removeItem(\"token\");\n          this.props.history.push(\"/login\");\n        }\n      });\n    };\n\n    this.state = {\n      loading: true,\n      dots: '.'\n    };\n    this.interval = 0;\n  }\n\n  componentDidMount() {\n    const token = localStorage.getItem(\"token\");\n    setTimeout(() => {\n      if (token) {\n        this.verifyToken(token);\n      } else {\n        this.props.history.push(\"/login\");\n      }\n    }, 2000);\n    this.interval = setInterval(() => {\n      this.state.dots.length === 5 ? this.setState({\n        dots: '.'\n      }) : this.setState({\n        dots: this.state.dots + '.'\n      });\n    }, 250);\n  }\n\n  render() {\n    const splash = React.createElement(\"div\", {\n      className: \"full-centered\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 57\n      },\n      __self: this\n    }, React.createElement(\"h1\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 58\n      },\n      __self: this\n    }, \"Carganding \", this.state.dots));\n    return this.state.loading ? splash : this.props.children;\n  }\n\n}\n\nexport default withRouter(Splash);","map":{"version":3,"sources":["/home/jaime/Documents/React_Feed-ReactCourse2020/src/components/Splash.js"],"names":["React","Component","withRouter","Splash","constructor","props","verifyToken","token","config","method","headers","authorization","fetch","then","res","ok","setState","loading","clearInterval","interval","localStorage","removeItem","history","push","state","dots","componentDidMount","getItem","setTimeout","setInterval","length","render","splash","children"],"mappings":";AAAA,OAAOA,KAAP,IAAeC,SAAf,QAA+B,OAA/B;AACA,SAAQC,UAAR,QAAyB,kBAAzB;;AAEA,MAAMC,MAAN,SAAqBF,SAArB,CAA8B;AAE7BG,EAAAA,WAAW,CAACC,KAAD,EAAO;AACjB,UAAMA,KAAN;;AADiB,SA0BlBC,WA1BkB,GA0BJ,MAAOC,KAAP,IAAiB;AAC9B,UAAIC,MAAM,GAAG;AACZC,QAAAA,MAAM,EAAG,KADG;AAEZC,QAAAA,OAAO,EAAC;AACPC,UAAAA,aAAa,EAAG,UAASJ,KAAM;AADxB;AAFI,OAAb;AAOAK,MAAAA,KAAK,CAAC,kDAAD,EAAqDJ,MAArD,CAAL,CACEK,IADF,CACOC,GAAG,IAAI;AACZ,YAAIA,GAAG,CAACC,EAAR,EAAW;AACV,eAAKC,QAAL,CAAc;AACbC,YAAAA,OAAO,EAAE;AADI,WAAd;AAIAC,UAAAA,aAAa,CAAC,KAAKC,QAAN,CAAb;AACA,SAND,MAMK;AACJC,UAAAA,YAAY,CAACC,UAAb,CAAwB,OAAxB;AACA,eAAKhB,KAAL,CAAWiB,OAAX,CAAmBC,IAAnB,CAAwB,QAAxB;AACA;AACD,OAZF;AAaA,KA/CiB;;AAGjB,SAAKC,KAAL,GAAa;AACZP,MAAAA,OAAO,EAAE,IADG;AAEZQ,MAAAA,IAAI,EAAE;AAFM,KAAb;AAKA,SAAKN,QAAL,GAAgB,CAAhB;AACA;;AAEDO,EAAAA,iBAAiB,GAAE;AAClB,UAAMnB,KAAK,GAAGa,YAAY,CAACO,OAAb,CAAqB,OAArB,CAAd;AACAC,IAAAA,UAAU,CAAC,MAAI;AACd,UAAIrB,KAAJ,EAAW;AACV,aAAKD,WAAL,CAAiBC,KAAjB;AACA,OAFD,MAEK;AACJ,aAAKF,KAAL,CAAWiB,OAAX,CAAmBC,IAAnB,CAAwB,QAAxB;AACA;AACD,KANS,EAMP,IANO,CAAV;AAQA,SAAKJ,QAAL,GAAgBU,WAAW,CAAC,MAAI;AAC/B,WAAKL,KAAL,CAAWC,IAAX,CAAgBK,MAAhB,KAA2B,CAA3B,GAA+B,KAAKd,QAAL,CAAc;AAACS,QAAAA,IAAI,EAAE;AAAP,OAAd,CAA/B,GAA4D,KAAKT,QAAL,CAAc;AAACS,QAAAA,IAAI,EAAE,KAAKD,KAAL,CAAWC,IAAX,GAAkB;AAAzB,OAAd,CAA5D;AACA,KAF0B,EAEzB,GAFyB,CAA3B;AAGA;;AAyBDM,EAAAA,MAAM,GAAE;AACP,UAAMC,MAAM,GACX;AAAK,MAAA,SAAS,EAAC,eAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAAgB,KAAKR,KAAL,CAAWC,IAA3B,CADD,CADD;AAKA,WAAO,KAAKD,KAAL,CAAWP,OAAX,GAAqBe,MAArB,GAA8B,KAAK3B,KAAL,CAAW4B,QAAhD;AACA;;AA1D4B;;AA8D9B,eAAe/B,UAAU,CAACC,MAAD,CAAzB","sourcesContent":["import React, {Component} from \"react\";\nimport {withRouter} from \"react-router-dom\";\n\nclass Splash extends Component{\n\n\tconstructor(props){\n\t\tsuper(props);\n\n\t\tthis.state = {\n\t\t\tloading: true,\n\t\t\tdots: '.',\n\t\t}\n\n\t\tthis.interval = 0;\n\t}\n\n\tcomponentDidMount(){\n\t\tconst token = localStorage.getItem(\"token\");\n\t\tsetTimeout(()=>{\n\t\t\tif( token ){\n\t\t\t\tthis.verifyToken(token);\n\t\t\t}else{\n\t\t\t\tthis.props.history.push(\"/login\")\n\t\t\t}\n\t\t}, 2000);\n\n\t\tthis.interval = setInterval(()=>{\n\t\t\tthis.state.dots.length === 5 ? this.setState({dots: '.'}) : this.setState({dots: this.state.dots + '.'})\n\t\t},250);\t\t\n\t}\n\n\tverifyToken = async (token) => {\n\t\tlet config = {\n\t\t\tmethod : 'GET',\n\t\t\theaders:{\n\t\t\t\tauthorization: `Bearer ${token}`\n\t\t\t}\n\t\t}\n\n\t\tfetch('https://reactcourseapi.herokuapp.com/verifytoken', config)\n\t\t\t.then(res => {\n\t\t\t\tif (res.ok){\n\t\t\t\t\tthis.setState({\n\t\t\t\t\t\tloading: false,\n\t\t\t\t\t})\n\n\t\t\t\t\tclearInterval(this.interval)\n\t\t\t\t}else{\n\t\t\t\t\tlocalStorage.removeItem(\"token\");\n\t\t\t\t\tthis.props.history.push(\"/login\");\n\t\t\t\t}\n\t\t\t})\n\t}\n\n\trender(){\n\t\tconst splash = (\n\t\t\t<div className=\"full-centered\">\n\t\t\t\t<h1>Carganding {this.state.dots}</h1>\n\t\t\t</div>\n\t\t);\n\t\treturn this.state.loading ? splash : this.props.children\n\t}\n\n}\n\nexport default withRouter(Splash);"]},"metadata":{},"sourceType":"module"}